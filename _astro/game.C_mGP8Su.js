let m=!1,c,v,d=7e3,i=!1,s=null,f=null,I,r,h,E,u=!1;const p={addition:50,subtraction:20,multiplication:10,division:100};function B(e){const t=g(r),n=g(r);let o,a;switch(e){case"addition":o=`${t} + ${n}`,a=t+n;break;case"subtraction":o=`${t} - ${Math.min(n,t)}`,a=t-Math.min(n,t);break;case"multiplication":o=`${t} * ${n}`,a=t*n;break;case"division":const l=g(Math.min(r,12)-1)+2;a=t*l,o=`${a} รท ${l}`,a/=l;break}return{problem:o,answer:a}}function g(e){return Math.floor(Math.random()*(e+1))}function w(e){if(m)return;const t=document.getElementById("gameContainer"),n=document.getElementById("practiceMode")?.checked||!1;if(!t)return;const o=document.createElement("div");if(u)o.className="tile absolute bg-red-500 text-white p-2 rounded text-lg font-bold";else{o.className="tile absolute bg-green-500 text-white p-2 rounded text-lg font-bold";const a=B(e);h=a.problem,E=a.answer}o.textContent=h,o.dataset.answer=E.toString(),o.style.left="50%",o.style.transform="translateX(-50%)",o.style.animation=`fall ${d}ms linear forwards`,t.appendChild(o),setTimeout(()=>C(o,n),d)}function C(e,t){!m&&e.parentNode&&(e.remove(),t?(u=!0,b()):L())}function k(){if(!i)return;const e=document.getElementById("answerInput");if(!e)return;const t=parseInt(e.value),n=document.querySelectorAll(".tile");if(n.length===0){e.value="",e.focus();return}const o=n[0],a=parseInt(o.dataset.answer||"0");!isNaN(t)&&t.toString().length===a.toString().length&&(a===t?(u=!1,o.remove(),b()):u=!0,e.value="",e.focus())}function b(){const e=document.getElementById("score");if(e){const t=parseInt(e.textContent||"0"),n=u?t===0?0:t-1:t+1;e.textContent=n.toString()}}function L(){m=!0,i=!1,O(),document.querySelectorAll(".tile").forEach(e=>{e instanceof HTMLElement&&(e.style.animation="none")}),N()}function O(){c&&clearInterval(c),v&&clearInterval(v)}function N(){const e=document.createElement("div");e.id="gameOverOverlay",e.className="fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center flex-col z-50";const t=document.createElement("h1");t.textContent="Game Over!",t.className="text-3xl font-bold text-white mb-4";const n=document.createElement("button");n.textContent="OK",n.className="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",n.addEventListener("click",y),e.appendChild(t),e.appendChild(n),document.body.appendChild(e),n.focus(),document.addEventListener("keydown",$)}function $(e){(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),y())}function y(){const e=document.getElementById("gameOverOverlay");e&&e.remove(),m=!1,G(),location.reload()}function G(){const e=document.getElementById("levelSlider"),t=document.getElementById("maxNoInput"),n=document.getElementById("practiceMode")?.checked||!1;e&&(s=e.value,localStorage.setItem("savedLevelValue",s)),t&&(f=parseInt(t.value),localStorage.setItem(`savedMaxNo_${I}`,f.toString())),localStorage.setItem("practiceMode",n.toString())}function A(){const e=document.getElementById("answerInput");e&&i&&e.focus()}function D(e){I=e,m=!1,i=!0;const t=document.getElementById("gameContainer");t&&(t.innerHTML=""),w(e),S(e),v=setInterval(A,100);const n=document.getElementById("spelaButton");if(n){const o=window.location.pathname.includes("/en/");n.textContent=o?"Quit":"Sluta"}}function S(e){c&&clearInterval(c),c=setInterval(()=>w(e),d+10)}function x(e,t){d=e,i&&(S(t),H())}function H(){document.querySelectorAll(".tile").forEach(e=>{if(e instanceof HTMLElement){const t=R(e);e.style.animation=`fall ${t}ms linear forwards`}})}function R(e){const t=e.offsetTop,n=e.parentElement.offsetHeight;return(n-t)/n*d}function V(e){I=e,document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("answerInput"),n=document.getElementById("levelSlider"),o=document.getElementById("maxNoInput");T(e,o,n),q(e,t,n,o)})}function T(e,t,n){f=parseInt(localStorage.getItem(`savedMaxNo_${e}`)||"0"),r=f||p[e],t&&(t.value=r.toString(),t.addEventListener("change",()=>{r=parseInt(t.value)||p[e],localStorage.setItem(`savedMaxNo_${e}`,r.toString())})),s=localStorage.getItem("savedLevelValue")||"1",s&&n&&(n.value=s,x(M(s),e)),localStorage.getItem("practiceMode")==="true"&&(document.getElementById("practiceMode").checked=!0)}function q(e,t,n,o){const a=document.getElementById("spelaButton");if(a){const l=window.location.pathname.includes("/en/");a.addEventListener("click",()=>{if(i){location.reload();return}o&&(r=parseInt(o.value)||p[e]),D(e),a.textContent=l?"Quit":"Sluta"})}n&&n.addEventListener("input",l=>{x(M(l.target.value),e)}),t&&t.addEventListener("keyup",k)}function M(e){return{1:7e3,2:5e3,3:3e3,4:2e3,5:1200}[e]||7e3}export{V as i};
