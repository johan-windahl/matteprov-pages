let c=!1,i,v,l=6e3,d=!1,s=null,m=null,p,r;const g={addition:50,subtraction:20,multiplication:10,division:100};function w(e){let n,t,o,a;switch(e){case"addition":n=Math.floor(Math.random()*(r+1)),t=Math.floor(Math.random()*(r+1)),o=`${n} + ${t}`,a=n+t;break;case"subtraction":n=Math.floor(Math.random()*(r+1)),t=Math.floor(Math.random()*(n+1)),o=`${n} - ${t}`,a=n-t;break;case"multiplication":n=Math.floor(Math.random()*(r+1)),t=Math.floor(Math.random()*(r+1)),o=`${n} * ${t}`,a=n*t;break;case"division":t=Math.floor(Math.random()*(Math.min(r,12)-1))+2,n=t*(Math.floor(Math.random()*(r/t))+1),o=`${n} รท ${t}`,a=n/t;break}return{problem:o,answer:a}}function I(e){const n=document.getElementById("spelaButton");n&&(n.disabled=!e)}function y(e){if(c)return;const n=document.getElementById("gameContainer");if(!n)return;const t=document.createElement("div");t.className="tile absolute bg-green-500 text-white p-2 rounded text-lg font-bold";const{problem:o,answer:a}=w(e);t.textContent=o,t.dataset.answer=a.toString(),t.style.left="50%",t.style.transform="translateX(-50%)",t.style.animation=`fall ${l}ms linear forwards`,n.appendChild(t),setTimeout(()=>{!c&&t.parentNode===n&&(t.remove(),B())},l)}function M(){if(!d)return;const e=document.getElementById("answerInput");if(!e)return;const n=parseInt(e.value),t=document.querySelectorAll(".tile");if(t.length===0){e.value="",e.focus();return}const o=t[0],a=parseInt(o.dataset.answer||"0");!isNaN(n)&&n.toString().length===a.toString().length&&(a===n&&(o.remove(),b()),e.value="",e.focus())}function b(){const e=document.getElementById("score");if(e){const n=parseInt(e.textContent||"0");e.textContent=(n+1).toString()}}function B(){c=!0,d=!1,i&&clearInterval(i),v&&clearInterval(v),document.querySelectorAll(".tile").forEach(o=>{if(o instanceof HTMLElement){const a=window.getComputedStyle(o),u=parseFloat(a.top);o.style.animation="none",o.style.top=`${u}px`}});const e=document.createElement("div");e.id="gameOverOverlay",e.className="fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center flex-col z-50";const n=document.createElement("h1");n.textContent="Game Over!",n.className="text-3xl font-bold text-white mb-4";const t=document.createElement("button");t.textContent="OK",t.className="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",t.addEventListener("click",S),e.appendChild(n),e.appendChild(t),document.body.appendChild(e),I(!0),t.focus(),document.addEventListener("keydown",N)}function N(e){(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),S())}function S(){const e=document.getElementById("gameOverOverlay");e&&e.remove(),c=!1,I(!1);const n=document.getElementById("levelSlider"),t=document.getElementById("maxNoInput");n&&(s=n.value,localStorage.setItem("savedLevelValue",s)),t&&(m=parseInt(t.value),localStorage.setItem(`savedMaxNo_${p}`,m.toString())),location.reload()}function C(){const e=document.getElementById("answerInput");e&&d&&e.focus()}function L(e){p=e,c=!1,d=!0;const n=document.getElementById("gameContainer");n&&(n.innerHTML=""),y(e),x(e),v=setInterval(C,100),I(!0)}function x(e){i&&clearInterval(i),i=setInterval(()=>y(e),l),console.log("Game runner updated with speed:",l)}function h(e,n){l=e,console.log("Speed set to:",l),d&&(x(n),document.querySelectorAll(".tile").forEach(t=>{if(t instanceof HTMLElement){const o=t.offsetTop,a=t.parentElement.offsetHeight,f=(a-o)/a*l;t.style.animation=`fall ${f}ms linear forwards`}}))}function O(e){p=e,document.addEventListener("DOMContentLoaded",()=>{const n=document.getElementById("answerInput"),t=document.getElementById("levelSlider"),o=document.getElementById("maxNoInput");m=parseInt(localStorage.getItem(`savedMaxNo_${e}`)||"0"),r=m||g[e],o&&(o.value=r.toString(),o.addEventListener("change",()=>{r=parseInt(o.value)||g[e],o.value=r.toString(),localStorage.setItem(`savedMaxNo_${e}`,r.toString())})),s=localStorage.getItem("savedLevelValue"),s&&t&&(t.value=s,h(E(s),e));const a=document.getElementById("spelaButton");a&&a.addEventListener("click",()=>{o&&(r=parseInt(o.value)||g[e],o.value=r.toString()),L(e)}),t&&t.addEventListener("input",u=>{const f=u.target.value;h(E(f),e)}),n&&n.addEventListener("keyup",M)})}function E(e){switch(e){case"1":return 6e3;case"2":return 3e3;case"3":return 2e3;case"4":return 1500;case"5":return 1200;default:return 6e3}}export{O as i};
